{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport default async function onSearch(searchQuery, currentPage) {\n    const KEY_API = \"42986246-3ae10d3224d15127557fd6ee9\";\n    const BASE_URL = \"https://pixabay.com/api/\";\n    const searchParams = new URLSearchParams({\n        key: KEY_API,\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: currentPage,\n        per_page: 15\n    });\n\n    const response = await axios.get(`${BASE_URL}?${searchParams}`);\n    return response.data;\n}\n","export function createGalleryMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n   <div class=\"galleryItem-wrapper\">\n        <div class=\"galleryCard-wrapper\">\n            <li class=\"gallery_items\">\n                <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"galleryItems-photo\"></a>\n                <div class=\"gallery-textWrapper\">\n                    <ul class=\"galleryItems-list\">\n                        <li class=\"galleryItem\">\n                            <h2>Likes</h2>\n                            <p>${likes}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Views</h2>\n                            <p>${views}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Comments</h2>\n                            <p>${comments}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Downloads</h2>\n                            <p>${downloads}</p>\n                        </li>\n                    </ul>\n                </div>\n                \n            </li>\n        </div>\n    </div>`).join(\"\");\n}\n\n","import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport onSearch from \"./js/pixabay-api\";\nimport { createGalleryMarkup } from \"./js/render-functions\";\n\nconst form = document.querySelector(\".search-form\");\nconst galleryList = document.querySelector(\".gallery-list\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".loadMoreBtn\");\nconst inputData = document.querySelector('input[type=\"text\"]');\nconst goTopBtn = document.querySelector(\".go-TopIMG\");\n\nlet gallery = new SimpleLightbox('.gallery a',\n    {\n        captionsData: 'alt',\n        captionDelay: 250,\n        captionPosition: 'bottom',\n        widthRatio: 0.9,\n        heightRatio: 0.8,\n    });\nlet searchQuery;\nlet currentGalleryLength;\nlet totalPages;\nlet currentHits;\nlet currentPage = 1;\nlet currentLenght;\n\nloaderHidden();\nloadMoreBtnHidden();\nform.addEventListener(\"submit\", onFormSubmit);\n\nfunction onFormSubmit(evt) {\n    evt.preventDefault();\n    searchQuery = inputData.value.trim();\n    loaderShow();\n    onSearch(searchQuery);\n\n    if (!searchQuery) {\n        iziToast.error({\n            title: err,\n            position: \"topRight\",\n            message: \"Oops! Input must not be empty!\",\n        })\n    };\n    onSearch(searchQuery).then(data => {\n        loaderShow();\n        loadMoreBtnHidden();\n        currentHits = data.totalHits;\n        currentGalleryLength = findArrLenght(data.hits);\n        totalPages = Math.ceil(currentHits / currentGalleryLength);\n        cleanInput();\n        if (!data.total) {\n            iziToast.error({\n                title: \"Error\",\n                position: \"topRight\",\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            galleryList.innerHTML = \"\";\n        };\n        if (data.total) {\n            loadMoreBtnShow();\n        }\n        galleryList.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(data.hits));\n        gallery.refresh();\n        loaderHidden();\n    }).catch(err => {\n        iziToast.error({\n            title: err,\n            position: \"topRight\",\n            message: \"Oops! Something went wrong!\",\n        });\n    })\n\n    function findArrLenght(arr) {\n        currentLenght = 0;\n        for (let key in arr) {\n            currentLenght += 1\n        }\n        return currentLenght\n    }\n};\n\nloadMoreBtn.addEventListener(\"click\", loadMorePictures);\n\nfunction loadMorePictures() {\n    loadMoreBtnHidden();\n    loaderShow();\n    currentPage += 1;\n    if (currentPage * currentLenght >= currentHits) {\n        loadMoreBtnHidden();\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n        });\n    }\n\n    onSearch(searchQuery, currentPage).then(data => {\n        galleryList.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(data.hits));\n        gallery.refresh();\n        scrollGallery()\n        loadMoreBtnShow();\n    }\n    ).catch(err => {\n        console.dir(err)\n        iziToast.error({\n            title: err,\n            position: \"topRight\",\n            message: err.message,\n        });\n    })\n        .finally(() => {\n            loaderHidden();\n            if (currentPage * currentLenght >= currentHits) {\n                loadMoreBtnHidden();\n            }\n        });\n}\n\nfunction loaderShow() {\n    loader.style.display = \"block\";\n}\nfunction loaderHidden() {\n    loader.style.display = \"none\"\n}\n\n\nfunction loadMoreBtnShow() {\n    loadMoreBtn.style.display = \"block\"\n}\nfunction loadMoreBtnHidden() {\n    loadMoreBtn.style.display = \"none\"\n}\n\nfunction cleanInput() {\n    return inputData.value = \"\"\n}\n\nfunction scrollGallery() {\n    const galleryCard = document.querySelector('.galleryCard-wrapper');\n\n    if (galleryCard) {\n        const cardHeight = galleryCard.getBoundingClientRect().height;\n\n        window.scrollBy({\n            top: cardHeight * 2,\n            left: 0,\n            behavior: 'smooth'\n        });\n    }\n}\n\ngoTopBtn.style.display = \"none\";\nwindow.addEventListener('scroll', function () {\n    if (window.scrollY > 300) {\n        goTopBtn.style.display = 'block';\n    } else {\n        goTopBtn.style.display = 'none';\n    }\n});\ngoTopBtn.addEventListener(\"click\", onTop);\nfunction onTop() {\n    if (window.scrollY > 0) {\n        window.scrollTo({\n            top: 0,\n            behavior: \"smooth\"\n        })\n    }\n}"],"names":["onSearch","searchQuery","currentPage","KEY_API","BASE_URL","searchParams","axios","createGalleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","galleryList","loader","loadMoreBtn","inputData","goTopBtn","gallery","SimpleLightbox","currentHits","currentLenght","loaderHidden","loadMoreBtnHidden","onFormSubmit","evt","loaderShow","iziToast","data","findArrLenght","cleanInput","loadMoreBtnShow","err","key","loadMorePictures","scrollGallery","galleryCard","cardHeight","onTop"],"mappings":"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"}