{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function createGalleryMarkup(arr) {\n\n\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n   <div class=\"galleryItem-wrapper\">\n        <div class=\"galleryCard-wrapper\">\n            <li class=\"gallery_items\">\n                <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"galleryItems-photo\"></a>\n                <div class=\"gallery-textWrapper\">\n                    <ul class=\"galleryItems-list\">\n                        <li class=\"galleryItem\">\n                            <h2>Likes</h2>\n                            <p>${likes}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Views</h2>\n                            <p>${views}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Comments</h2>\n                            <p>${comments}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Downloads</h2>\n                            <p>${downloads}</p>\n                        </li>\n                    </ul>\n                </div>\n                \n            </li>\n        </div>\n    </div>`).join(\"\");\n\n  \n}\n\n","import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nimport { createGalleryMarkup } from \"./render-functions\";\nconst form = document.querySelector(\".search-form\");\nconst galleryContainer = document.querySelector(\".gallery\");\nconst galleryList = document.querySelector(\".gallery-list\");\nconst loadMoreBtn = document.querySelector(\".loadMoreBtn\");\nlet currentHits = 0;\n\nexport default function onSearch(searchQuery, currentPage) {\n    const KEY_API = \"42986246-3ae10d3224d15127557fd6ee9\";\n    const BASE_URL = \"https://pixabay.com/api/\";\n    const searchParams = new URLSearchParams({\n        key: KEY_API,\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: currentPage,\n        per_page: 15\n    });\n\n    const fetchPictures = async () => {\n        const response = await axios.get(`${BASE_URL}?${searchParams}`);\n        return response.data;\n    };\n\n    fetchPictures()\n        .then(data => {\n            if (!data.total) {\n                iziToast.error({\n                    title: \"Error\",\n                    position: \"topRight\",\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                });\n            };\n\n            if (currentHits - data.totalHits) {\n                currentHits += Number(data.hits.length);\n                // console.log(`Total hits: ${currentHits}`)\n                // console.dir(data.totalHits)\n            }\n            else {\n                currentHits = 0;\n                form.reset()\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n                setTimeout(() => { loadMoreBtn.hidden = true }, 20);\n                return\n                // Додав setTimeout з більшою затримкою, щоб кнопка зникала після фетчу останнього масиву зображень\n            }\n\n\n            galleryList.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(data.hits));\n\n            let gallery = new SimpleLightbox('.gallery a',\n                {\n                    captionsData: 'alt',\n                    captionDelay: 250,\n                    captionPosition: 'bottom',\n                    widthRatio: 0.9,\n                    heightRatio: 0.8,\n                });\n            gallery.refresh();\n\n        })\n        .catch(err => {\n            iziToast.error({\n                title: err,\n                position: \"topRight\",\n                message: \"Oops! Something went wrong!\",\n            });\n        })\n        .finally(() => {\n            loader.hidden = true;\n            setTimeout(() => { loadMoreBtn.hidden = false }, 0);\n        });\n}","\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport onSearch from \"./js/pixabay-api\";\n\nconst form = document.querySelector(\".search-form\");\nconst galleryList = document.querySelector(\".gallery-list\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".loadMoreBtn\");\nlet currentHits = 0;\n\n\nform.addEventListener(\"submit\", onFormSubmit);\nloadMoreBtn.addEventListener(\"click\", loadMorePictures)\nloader.hidden = true;\nloadMoreBtn.hidden = true;\nlet currentPage = 1;\nlet searchQuery;\n\nfunction onFormSubmit(evt) {\n    evt.preventDefault();\n    currentHits = 0;\n    galleryList.innerHTML = \"\";\n    loader.hidden = false;\n    const { searchRequest } = evt.currentTarget.elements;\n    searchQuery = searchRequest.value;\n    onSearch(searchQuery);\n    form.reset();\n    return searchQuery\n}\n\nfunction loadMorePictures() {\n    currentPage += 1;\n    loader.hidden = false;\n    loadMoreBtn.hidden = true;\n\n    if (!onSearch(searchQuery, currentPage)) {\n        currentPage = 1;\n    }\n    else { onSearch(searchQuery, currentPage) };\n}\n\nconst galleryCard = document.querySelector('.galleryCard-wrapper');\n\nif (galleryCard) {\n    const cardRect = galleryCard.getBoundingClientRect();\n    const cardHeight = cardRect.height;\n\n    window.scrollBy({\n        top: cardHeight + cardHeight * 2,\n        left: 0,\n        behavior: 'smooth'\n    });\n}"],"names":["createGalleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","galleryList","loadMoreBtn","currentHits","onSearch","searchQuery","currentPage","KEY_API","BASE_URL","searchParams","axios","data","iziToast","SimpleLightbox","err","loader","onFormSubmit","loadMorePictures","evt","searchRequest","galleryCard","cardHeight"],"mappings":"+vBAIO,SAASA,EAAoBC,EAAK,CAGrC,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA;AAAA;AAAA,2BAItEL,CAAa;AAAA,4BACZD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,iCAKrBC,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAO/B,EAAE,KAAK,EAAE,CAGpB,CC/BA,MAAMC,EAAO,SAAS,cAAc,cAAc,EACzB,SAAS,cAAc,UAAU,EAC1D,MAAMC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAc,SAAS,cAAc,cAAc,EACzD,IAAIC,EAAc,EAEH,SAASC,EAASC,EAAaC,EAAa,CACvD,MAAMC,EAAU,qCACVC,EAAW,2BACXC,EAAe,IAAI,gBAAgB,CACrC,IAAKF,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EAClB,CAAK,GAEqB,UACD,MAAMI,EAAM,IAAI,GAAGF,CAAQ,IAAIC,CAAY,EAAE,GAC9C,MAGL,EACV,KAAKE,GAAQ,CASV,GARKA,EAAK,OACNC,EAAS,MAAM,CACX,MAAO,QACP,SAAU,WACV,QAAS,0EAC7B,CAAiB,EAGDT,EAAcQ,EAAK,UACnBR,GAAe,OAAOQ,EAAK,KAAK,MAAM,MAIrC,CACDR,EAAc,EACdH,EAAK,MAAO,EACZY,EAAS,KAAK,CACV,QAAS,4DAC7B,CAAiB,EACD,WAAW,IAAM,CAAEV,EAAY,OAAS,EAAI,EAAI,EAAE,EAClD,MAEH,CAGDD,EAAY,mBAAmB,YAAaV,EAAoBoB,EAAK,IAAI,CAAC,EAE5D,IAAIE,EAAe,aAC7B,CACI,aAAc,MACd,aAAc,IACd,gBAAiB,SACjB,WAAY,GACZ,YAAa,EACjC,CAAiB,EACG,QAAO,CAE3B,CAAS,EACA,MAAMC,GAAO,CACVF,EAAS,MAAM,CACX,MAAOE,EACP,SAAU,WACV,QAAS,6BACzB,CAAa,CACb,CAAS,EACA,QAAQ,IAAM,CACX,OAAO,OAAS,GAChB,WAAW,IAAM,CAAEZ,EAAY,OAAS,EAAK,EAAI,CAAC,CAC9D,CAAS,CACT,CC1EA,MAAMF,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAc,SAAS,cAAc,eAAe,EACpDc,EAAS,SAAS,cAAc,SAAS,EACzCb,EAAc,SAAS,cAAc,cAAc,EAIzDF,EAAK,iBAAiB,SAAUgB,CAAY,EAC5Cd,EAAY,iBAAiB,QAASe,CAAgB,EACtDF,EAAO,OAAS,GAChBb,EAAY,OAAS,GACrB,IAAII,EAAc,EACdD,EAEJ,SAASW,EAAaE,EAAK,CACvBA,EAAI,eAAc,EAElBjB,EAAY,UAAY,GACxBc,EAAO,OAAS,GAChB,KAAM,CAAE,cAAAI,CAAe,EAAGD,EAAI,cAAc,SAC5C,OAAAb,EAAcc,EAAc,MAC5Bf,EAASC,CAAW,EACpBL,EAAK,MAAK,EACHK,CACX,CAEA,SAASY,GAAmB,CACxBX,GAAe,EACfS,EAAO,OAAS,GAChBb,EAAY,OAAS,GAEhBE,EAASC,EAAaC,CAAW,EAG/BF,EAASC,EAAaC,CAAW,EAFpCA,EAAc,CAGtB,CAEA,MAAMc,EAAc,SAAS,cAAc,sBAAsB,EAEjE,GAAIA,EAAa,CAEb,MAAMC,EADWD,EAAY,wBACD,OAE5B,OAAO,SAAS,CACZ,IAAKC,EAAaA,EAAa,EAC/B,KAAM,EACN,SAAU,QAClB,CAAK,CACL"}