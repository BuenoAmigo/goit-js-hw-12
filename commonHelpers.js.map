{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function createGalleryMarkup(arr) {\n\n\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n   <div class=\"galleryItem-wrapper\">\n        <div class=\"galleryCard-wrapper\">\n            <li class=\"gallery_items\">\n                <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"galleryItems-photo\"></a>\n                <div class=\"gallery-textWrapper\">\n                    <ul class=\"galleryItems-list\">\n                        <li class=\"galleryItem\">\n                            <h2>Likes</h2>\n                            <p>${likes}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Views</h2>\n                            <p>${views}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Comments</h2>\n                            <p>${comments}</p>\n                        </li>\n                        <li class=\"galleryItem\">\n                            <h2>Downloads</h2>\n                            <p>${downloads}</p>\n                        </li>\n                    </ul>\n                </div>\n                \n            </li>\n        </div>\n    </div>`).join(\"\");\n\n}\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nimport { createGalleryMarkup } from \"./render-functions\";\nconst form = document.querySelector(\".search-form\");\nconst galleryList = document.querySelector(\".gallery-list\");\nconst loadMoreBtn = document.querySelector(\".loadMoreBtn\");\nlet currentHits = 0;\n\nexport default function onSearch(searchQuery, currentPage) {\n    const KEY_API = \"42986246-3ae10d3224d15127557fd6ee9\";\n    const BASE_URL = \"https://pixabay.com/api/\";\n    const searchParams = new URLSearchParams({\n        key: KEY_API,\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: currentPage,\n        per_page: 100\n    });\n\n    const fetchPictures = async () => {\n        const response = await axios.get(`${BASE_URL}?${searchParams}`);\n        return response.data;\n    };\n\n    fetchPictures()\n        .then(data => {\n            console.log(data)\n            if (!data.total) {\n                iziToast.error({\n                    title: \"Error\",\n                    position: \"topRight\",\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                });\n            };\n\n            if (currentHits - data.totalHits){\n               currentHits += Number(data.hits.length);\n                console.log(`Total hits: ${currentHits}`)\n                console.dir(data.totalHits)\n            }\n            else {\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n                setTimeout(() => { loadMoreBtn.hidden = true}, 20);\n                 // Додав setTimeout з більшою затримкою, щоб кнопка зникала після фетчу останнього масиву зображень\n                currentHits =0;\n                form.reset()\n            }\n    \n            \n            \n            galleryList.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(data.hits));\n        })\n        .catch(err => {\n            iziToast.error({\n                title: err,\n                position: \"topRight\",\n                message: \"Oops! Something went wrong!\",\n            });\n        })\n        .finally(() => {\n            loader.hidden = true;\n            setTimeout(() => { loadMoreBtn.hidden = false }, 0)\n\n        });\n}","\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport onSearch from \"./js/pixabay-api\";\n\nconst form = document.querySelector(\".search-form\");\nconst galleryContainer = document.querySelector(\".gallery\");\nconst galleryList = document.querySelector(\".gallery-list\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".loadMoreBtn\");\nlet currentHits = 0;\n\n\nform.addEventListener(\"submit\", onFormSubmit);\nloadMoreBtn.addEventListener(\"click\", loadMorePictures)\nloader.hidden = true;\nloadMoreBtn.hidden = true;\nlet currentPage = 1;\nlet searchQuery;\n\nfunction onFormSubmit(evt) {\n    evt.preventDefault();\n    currentHits = 0;\n    galleryList.innerHTML = \"\";\n    loader.hidden = false;\n    const { searchRequest } = evt.currentTarget.elements;\n    searchQuery = searchRequest.value;\n    onSearch(searchQuery);\n    form.reset();\n    return searchQuery\n}\n\nfunction loadMorePictures() {\n    currentPage += 1;\n    loader.hidden = false;\n    loadMoreBtn.hidden = true;\n    onSearch(searchQuery, currentPage);\n    // queryTotalPages = Math.ceil(searchQuery)\n\n}\n\n"],"names":["createGalleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","galleryList","loadMoreBtn","currentHits","onSearch","searchQuery","currentPage","KEY_API","BASE_URL","searchParams","axios","data","iziToast","err","loader","onFormSubmit","loadMorePictures","evt","searchRequest"],"mappings":"6vBAIO,SAASA,EAAoBC,EAAK,CAGrC,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA;AAAA;AAAA,2BAItEL,CAAa;AAAA,4BACZD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,iCAKrBC,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAO/B,EAAE,KAAK,EAAE,CAEpB,CCjCA,MAAMC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAc,SAAS,cAAc,cAAc,EACzD,IAAIC,EAAc,EAEH,SAASC,EAASC,EAAaC,EAAa,CACvD,MAAMC,EAAU,qCACVC,EAAW,2BACXC,EAAe,IAAI,gBAAgB,CACrC,IAAKF,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,GAClB,CAAK,GAEqB,UACD,MAAMI,EAAM,IAAI,GAAGF,CAAQ,IAAIC,CAAY,EAAE,GAC9C,MAGL,EACV,KAAKE,GAAQ,CACV,QAAQ,IAAIA,CAAI,EACXA,EAAK,OACNC,EAAS,MAAM,CACX,MAAO,QACP,SAAU,WACV,QAAS,0EAC7B,CAAiB,EAGDT,EAAcQ,EAAK,WACpBR,GAAe,OAAOQ,EAAK,KAAK,MAAM,EACrC,QAAQ,IAAI,eAAeR,CAAW,EAAE,EACxC,QAAQ,IAAIQ,EAAK,SAAS,IAG1BC,EAAS,KAAK,CACV,QAAS,4DAC7B,CAAiB,EACD,WAAW,IAAM,CAAEV,EAAY,OAAS,EAAI,EAAG,EAAE,EAEjDC,EAAa,EACbH,EAAK,MAAO,GAKhBC,EAAY,mBAAmB,YAAaV,EAAoBoB,EAAK,IAAI,CAAC,CACtF,CAAS,EACA,MAAME,GAAO,CACVD,EAAS,MAAM,CACX,MAAOC,EACP,SAAU,WACV,QAAS,6BACzB,CAAa,CACb,CAAS,EACA,QAAQ,IAAM,CACX,OAAO,OAAS,GAChB,WAAW,IAAM,CAAEX,EAAY,OAAS,EAAK,EAAI,CAAC,CAE9D,CAAS,CACT,CC7DA,MAAMF,EAAO,SAAS,cAAc,cAAc,EACzB,SAAS,cAAc,UAAU,EAC1D,MAAMC,EAAc,SAAS,cAAc,eAAe,EACpDa,EAAS,SAAS,cAAc,SAAS,EACzCZ,EAAc,SAAS,cAAc,cAAc,EAIzDF,EAAK,iBAAiB,SAAUe,CAAY,EAC5Cb,EAAY,iBAAiB,QAASc,CAAgB,EACtDF,EAAO,OAAS,GAChBZ,EAAY,OAAS,GACrB,IAAII,EAAc,EACdD,EAEJ,SAASU,EAAaE,EAAK,CACvBA,EAAI,eAAc,EAElBhB,EAAY,UAAY,GACxBa,EAAO,OAAS,GAChB,KAAM,CAAE,cAAAI,CAAe,EAAGD,EAAI,cAAc,SAC5C,OAAAZ,EAAca,EAAc,MAC5Bd,EAASC,CAAW,EACpBL,EAAK,MAAK,EACHK,CACX,CAEA,SAASW,GAAmB,CACxBV,GAAe,EACfQ,EAAO,OAAS,GAChBZ,EAAY,OAAS,GACrBE,EAASC,EAAaC,CAAW,CAGrC"}